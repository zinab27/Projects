let topBooks = [
  {
    id: 1,
    photo: "pics/1.jpg",
    title: "Yellowface",
    author: "R. F. Kuang",
    genre: "Fiction",
    published: "May 16, 2023",
    ISBN: "9780063250833",
    description: `White lies
                When Athena dies in a freak accident, June steals her unpublished manuscript and
                publishes it as her own under the ambiguous name Juniper Song.
                Dark humour But as evidence threatens June’s stolen success, she will discover exactly how far she
                will go to keep what she thinks she deserves.
                Deadly consequences… What happens next is entirely everyone else’s fault.
                With its totally immersive first- person voice, Yellowface grapples with questions of
                diversity, racism, and cultural appropriation, as well as the terrifying
                alienation of social media.R.F. Kuang’s novel is timely,razor - sharp, and eminently readable.`,
  },
  {
    id: 2,
    photo: "pics/2.jpg",
    title: "Weyward",
    author: "Emilia Hart",
    genre: "Fiction",
    published: "February 2, 2023",
    ISBN: "9781250280800",
    description: `I am a Weyward, and wild inside.
                        <br>
                        2019: Under cover of darkness, Kate flees London for ramshackle Weyward Cottage, inherited from a great aunt she barely remembers. 
                        With its tumbling ivy and overgrown garden, the cottage is worlds away from the abusive partner who tormented Kate. But she begins to 
                        suspect that her great aunt had a secret. One that lurks in the bones of the cottage, hidden ever since the witch-hunts of the 17th century.
                        <br>
                        1619: Altha is awaiting trial for the murder of a local farmer who was stampeded to death by his herd. As a girl, 
                        Altha’s mother taught her their magic, a kind not rooted in spell casting but in a deep knowledge of the natural world. 
                        But unusual women have always been deemed dangerous, and as the evidence for witchcraft is set out against Altha, she knows 
                        it will take all of her powers to maintain her freedom.
                        <br>
                        1942: As World War II rages, Violet is trapped in her family's grand, crumbling estate. Straitjacketed by societal convention, 
                        she longs for the robust education her brother receives––and for her mother, long deceased, who was rumored to have gone mad before her death. 
                        The only traces Violet has of her are a locket bearing the initial W and the word weyward scratched into the baseboard of her bedroom.
                        <br>
                        Weaving together the stories of three extraordinary women across five centuries, Emilia Hart's Weyward is an enthralling novel of 
                        female resilience and the transformative power of the natural world.`,
  },

  {
    id: 3,
    photo: "pics/3.jpg",
    title: "The Housemaid's Secret",
    author: "Freida McFadden",
    genre: "Thriller",
    published: "February 20, 2023",
    ISBN: "9780349132600",
    description: `“Don’t go in the guest bedroom.” A shadow falls on Douglas Garrick’s face as he touches the door with his fingertips. “My wife… she’s very ill.” 
                        As he continues showing me their incredible penthouse apartment, I have a terrible feeling about the woman behind closed doors. But I can’t risk 
                        losing this job—not if I want to keep my darkest secret safe…It’s hard to find an employer who doesn’t ask too many questions about my past. 
                        So I thank my lucky stars that the Garricks miraculously give me a job, cleaning their stunning penthouse with views across the city and 
                        preparing fancy meals in their shiny kitchen. I can work here for a while, stay quiet until I get what I want.It’s almost perfect. 
                        But I still haven’t met Mrs Garrick, or seen inside the guest bedroom. I’m sure I hear her crying. I notice spots of blood around the neck 
                        of her white nightgowns when I’m doing laundry. And one day I can’t help but knock on the door. When it gently swings open, what I see inside
                         changes everything… That’s when I make a promise. After all, I’ve done this before. I can protect Mrs Garrick while keeping my own secrets 
                         locked up safe.Douglas Garrick has done wrong. He is going to pay. It’s simply a question of how far I’m willing to go…`,
  },

  {
    id: 4,
    photo: "pics/4.jpg",
    title: "Happy Place",
    author: "Emily Henry",
    genre: "Romance",
    published: "April 25, 2023",
    ISBN: "9780241997932",
    description: `Harriet and Wyn have been 
                the perfect couple since they met in college—they go together like salt and pepper, honey and tea, lobster and rolls. 
                Except, now—for reasons they’re still not discussing—they don’t.They broke up six months ago. And still haven’t told 
                their best friends.Which is how they find themselves sharing the largest bedroom at the Maine cottage that has been 
                their friend group’s yearly getaway for the last decade. Their annual respite from the world, where for one vibrant, 
                blue week they leave behind their daily lives; have copious amounts of cheese, wine, and seafood; and soak up the salty
                coastal air with the people who understand them most.Only this year, Harriet and Wyn are lying through their teeth 
                while trying not to notice how desperately they still want each other. Because the cottage is for sale and this is 
                the last week they’ll all have together in this place. They can’t stand to break their friends’ hearts, and so they’ll
                play their parts. Harriet will be the driven surgical resident who never starts a fight, and Wyn will be the laid-back
                charmer who never lets the cracks show. It’s a flawless plan (if you look at it from a great distance and through a pair 
                of sunscreen-smeared sunglasses). After years of being in love, how hard can it be to fake it for one week… in front of 
                those who know you best?A couple who broke up months ago make a pact to pretend to still be together for their annual 
                weeklong vacation with their best friends in this glittering and wise new novel from #1 New York Times bestselling author Emily Henry.`,
  },
  {
    id: 5,
    photo: "pics/5.jpg",
    title: "Fourth Wing",
    author: "Rebecca Yarros",
    genre: "Fantasy",
    published: "May 2, 2023",
    ISBN: "9781649374042",
    description: `Enter the brutal and elite world
                 of a war college for dragon riders from USA Today bestselling author Rebecca Yarros. Twenty-year-old Violet Sorrengail
                  was supposed to enter the Scribe Quadrant, living a quiet life among books and history. Now, the commanding 
                  general—also known as her tough-as-talons mother—has ordered Violet to join the hundreds of candidates striving to
                   become the elite of Navarre: dragon riders. But when you’re smaller than everyone else and your body is brittle, 
                   death is only a heartbeat away...because dragons don’t bond to “fragile” humans. They incinerate them. With fewer 
                   dragons willing to bond than cadets, most would kill Violet to better their own chances of success. The rest would 
                   kill her just for being her mother’s daughter—like Xaden Riorson, the most powerful and ruthless wingleader in the 
                   Riders Quadrant. She’ll need every edge her wits can give her just to see the next sunrise. Yet, with every day that 
                   passes, the war outside grows more deadly, the kingdom\'s protective wards are failing, and the death toll continues 
                   to rise. Even worse, Violet begins to suspect leadership is hiding a terrible secret. Friends, enemies, lovers. 
                   Everyone at Basgiath War College has an agenda—because once you enter, there are only two ways out: graduate or die.`,
  },
  {
    id: 6,
    photo: "pics/6.jpg",
    title: "Hell Bent",
    author: "Leigh Bardugo",
    genre: "Horror",
    published: "January 10, 2023",
    ISBN: "9781250313102",
    description: `
                    Find a gateway to the underworld. Steal a soul out of hell. A simple plan, except people who make this particular journey rarely come back. But Galaxy “Alex” Stern is determined to
                break Darlington out of purgatory―even if it costs her a future at Lethe and at Yale.
                Forbidden from attempting a rescue, Alex and Dawes can’t call on the Ninth House for help, so they assemble a team of dubious allies to save the gentleman of Lethe. Together, they will have to navigate a maze of arcane
                texts and bizarre artifacts to uncover the societies’ most closely guarded secrets, and break every rule doing it. But when faculty members begin to die off, Alex knows these aren’t just accidents. Something deadly is at work in New Haven, 
                and if she is going to survive, she’ll have to reckon with the monsters of her past and a darkness built into the university’s very walls.
                Thick with history and packed with Bardugo’s signature twists, Hell Bent brings to life an intricate world full of magic, violence, and all too real monsters.
                `,
  },
  {
    id: 7,
    photo: "pics/7.jpg",
    title: "In the Lives of Puppets",
    author: "T.J. Klune",
    genre: "Science Fiction",
    published: "June 2, 2023",
    ISBN: "9781649374042",
    description: `
                    In a strange little home built into the branches of a grove of trees, live three robots—fatherly inventor android Giovanni Lawson, a pleasantly sadistic nurse machine, and a small
                vacuum desperate for love and attention. Victor Lawson, a human, lives there too. They’re a family, hidden and safe.
                The day Vic salvages and repairs an unfamiliar android labelled “HAP,” he learns of a shared dark past between Hap and Gio–a past spent hunting humans.
                When Hap unwittingly alerts robots from Gio’s former life to their whereabouts, the family is no longer hidden and safe. Gio is captured and taken back to his old laboratory in the City of Electric Dreams. So together, the rest of Vic’s 
                assembled family must journey across an unforgiving and otherworldly country to rescue Gio from decommission, or worse, reprogramming.
                Along the way to save Gio, amid conflicted feelings of betrayal and affection for Hap, Vic must decide for himself: Can he accept love with strings attached?
                Inspired by Carlo Collodi's The Adventures of Pinocchio, and like Swiss Family Robinson meets Wall-E, In the Lives of Puppets is a masterful stand-alone fantasy adventure from the beloved author who brought you The House in the Cerulean Sea and Under the Whispering Door.
                `,
  },
  {
    id: 8,
    photo: "pics/8.jpg",
    title: "Holly",
    author: "Stephen King",
    genre: "Horror",
    published: "September 5, 2023",
    ISBN: "9781668016138",
    description: `
                    Holly Gibney, one of Stephen King’s most compelling and ingeniously resourceful characters, returns in this thrilling novel to solve the gruesome truth behind multiple
                    disappearances in a midwestern town.
                    “Sometimes the universe throws you a rope.” — BILL HODGES
                `,
  },
];

const books = document.getElementsByClassName("books");
var j = 0;

for (var i = 0; i < topBooks.length; i++) {
  const book = document.createElement("div");
  i % 2 ? book.classList.add("book", "lowerBook") : book.classList.add("book");

  book.innerHTML = `
        <div class="image-container">
        <a href="bookdetails.html?title=${topBooks[i].title}">
        <img src="${topBooks[i].photo}" width="250" height="350">
        <span class="book-info">
            <span class="book-name">${topBooks[i].title}</span>
            <span class="book-author">${topBooks[i].author}</span>
        </span>
        </a>
      </div>
    `;

  books[0].appendChild(book);
}

// function logOut() {
//   localStorage.setItem("isLoggedIn", "false");
//   document.getElementById("login").style.display = "block";
//   document.getElementById("signup").style.display = "block";
//   document.getElementById("browse").style.display = "block";
//   document.getElementById("admin").style.display = "none";
//   document.getElementById("borrow").style.display = "none";
//   document.getElementById("logout").style.display = "none";
// }

function logOut() {
  fetch("./logout", {
    method: "POST",
    headers: {
      "X-CSRFToken": "{{ csrf_token }}",
      "Content-Type": "application/json",
    },
    body: JSON.stringify({ isLogin: false }),
  })
    .then((response) => {
      // Handle response
      window.location.href = "homepage";
    })
    .catch((error) => {
      console.error("Error:", error);
    });
}

document.addEventListener("DOMContentLoaded", function () {
  const isLoggedIn = localStorage.getItem("isLoggedIn");
  const user = localStorage.getItem("isUser");
  const admin = localStorage.getItem("isAdmin");
  console.log(isLoggedIn);

  if (isLoggedIn == "true" && admin == "true") {
    document.getElementById("login").style.display = "none";
    document.getElementById("signup").style.display = "none";
    document.getElementById("browse").style.display = "none";
    document.getElementById("borrow").style.display = "none";
    document.getElementById("admin").style.display = "block";
    document.getElementById("logout").style.display = "block";
  } else if (isLoggedIn == "true" && user == "true") {
    document.getElementById("login").style.display = "none";
    document.getElementById("signup").style.display = "none";
    document.getElementById("browse").style.display = "none";
    document.getElementById("admin").style.display = "none";
    document.getElementById("borrow").style.display = "block";
    document.getElementById("logout").style.display = "block";
  } else {
    document.getElementById("login").style.display = "block";
    document.getElementById("signup").style.display = "block";
    document.getElementById("browse").style.display = "block";
    document.getElementById("admin").style.display = "none";
    document.getElementById("borrow").style.display = "none";
    document.getElementById("logout").style.display = "none";
  }
});

function searchBooks() {
  let input = document.querySelector(".search-input");
  let filter = input.value.toUpperCase();
  let books = document.querySelectorAll(".book");

  books.forEach((book) => {
    let title = book.querySelector(".book-name").innerText.toUpperCase();

    let author = book.querySelector(".book-author").innerText.toUpperCase();

    if (title.includes(filter) || author.includes(filter)) {
      book.style.display = "";
    } else {
      book.style.display = "none";
    }
  });
}
